<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:bnu="http://bootsfaces.net/ui"
             xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
             xmlns:p="http://primefaces.org/ui">

    <ui:remove>
        <!--
                    Hint to editors: The menus follow the Chicago style of capitalization. Please capitalize everything but the "smaller" words. 
        -->
    </ui:remove>
    <h:form  id="customerForm" >
        <br></br>
    

        <bnu:row>
            <bnu:column>
                <bnu:button        
                    value="#{messages.newC}" look="success" 
                    style="float: right" onclick="$('addModalCust').modal()"/>
            </bnu:column>
        </bnu:row>
        <bnu:row>
            <bnu:column span="12">
                <bnu:messages  />
            </bnu:column>
        </bnu:row>
        <br></br>

        <bnu:dropButton value="#{messages.batchA}" style="float: left">
            <bnu:navLink value="#{messages.createS}" href="#{request.contextPath}/view/sales/createStatements.xhtml"></bnu:navLink>
            <bnu:navLink value="#{messages.emailC}"></bnu:navLink>
        </bnu:dropButton>

        <bnu:commandButton value="" iconAwesome="fa-cogs"  style="float: right" />
        <bnu:commandButton value="" iconAwesome="fa-clipboard" style="float: right" />
        <bnu:commandButton value="" iconAwesome="fa-print" style="float: right" />


        <bnu:dataTable  styleClass="table table-striped"
                        value="#{customerController.custL}" 
                        var="cust"
                        id="tblCust"
                        responsive="true"
                        >
            <bnu:dataTableColumn >
                <f:facet name="header">
                    <bnu:selectBooleanCheckbox  />
                </f:facet>
                <bnu:selectBooleanCheckbox value="#{cust.checkbox}" />
            </bnu:dataTableColumn>
            <bnu:dataTableColumn label="#{messages.Tcampo1}"  >
                
                <a href="#{request.contextPath}/view/sales/customer/customerDetail.xhtml?id=#{cust.idCust.toString()}" > <h:outputText value="#{cust.displayName}" /></a><br/>
                <small> <h:outputText value="#{cust.company}"  style="color: #999999" /></small>
            </bnu:dataTableColumn>
            <bnu:dataTableColumn label="#{messages.lblCustAddress}">
                <small> <h:outputText value="#{cust.street}" /><br/>
                <h:outputText value="#{cust.city}" />,<h:outputText value="#{cust.estate}" /> <h:outputText value=" #{cust.postalCode}" /></small>
            </bnu:dataTableColumn>
            <bnu:dataTableColumn label="#{messages.Tcampo3}" value="#{userData.formatMaster(cust.balance.toString())}"></bnu:dataTableColumn>            
            <bnu:dataTableColumn label="#{messages.Tcampo4}">
                <bnu:dropButton value="#{messages.lblOptions}" look="primary" >
                    <bnu:commandButton value="#{messages.lblReceivePayment}"  style="width:100%;border: none;" rendered="#{customerController.renderOptionMaster('REPAY', cust)}"  action="#{customerController.receivePayment(cust.idCust.toString())}"  />
                    <bnu:commandButton value="#{messages.lblCreateInvoice}" action="#{customerController.createInvoice('IN', cust.idCust.toString())}" style="width:100%;border: none;" />
                    <bnu:commandButton value="#{messages.lblCreateEstimate}" action="#{customerController.createInvoice('ES', cust.idCust.toString())}" style="width:100%;border: none;" />
                    <bnu:commandButton value="#{messages.lblCreateSalesReceipt}" action="#{customerController.createInvoice('SR', cust.idCust.toString())}" style="width:100%;border: none;" />
                    
                    <bnu:commandButton value="#{messages.lblMakeInactive}"  style="width:100%;border: none;"  rendered="#{customerController.renderOptionMaster('INAC',cust)}" />

                </bnu:dropButton>
            </bnu:dataTableColumn> 
        </bnu:dataTable>
    </h:form>  

                <!--Modal add-->
                                  <h:form id="customerFormAdd" >
                    <bnu:modal id="amodal2" styleClass="addCustModal" size="modal-lg" title="#{messages.lblCustomerInfo}" >
                        <bnu:row>
                            <bnu:column span="1" >
                                <label>#{messages.titleC}</label>
                                <bnu:inputText type="text" size="3" value="#{customerController.customer.title}"  class="title" name="title" onblur="customerFormHelper.displayName();"  />
                            </bnu:column>
                            <bnu:column span="2" >
                                <label>#{messages.fNameC}</label>
                                <bnu:inputText type="text" size="10" value="#{customerController.customer.firstname}" class="fname" name="fname"  onblur="customerFormHelper.displayName();"  />
                                
                            </bnu:column>
                            <bnu:column span="2" >
                                <label>#{messages.midNameC}</label>
                                <bnu:inputText type="text" size="10" value="#{customerController.customer.middlename}" class="mname" name="mname" onblur="customerFormHelper.displayName();"   />
                                
                            </bnu:column>
                            <bnu:column span="2" >
                                <label>#{messages.lastNameC}</label>
                                <bnu:inputText type="text" size="10" value="#{customerController.customer.lastname}" class="lname" name="lname" onblur="customerFormHelper.displayName();"   />
                                
                            </bnu:column>
                            <bnu:column span="1" >
                                <label>#{messages.suffixC}</label>
                                <bnu:inputText type="text" size="3" value="#{customerController.customer.suffixx}" class="suffix" name="suffix" onblur="customerFormHelper.displayName();"   />
                                
                            </bnu:column>
                            <bnu:column span="4" >
                                <bnu:inputText label="#{messages.email}" value="#{customerController.customer.email}" field-size="xs" />

                            </bnu:column>
                        </bnu:row>

                        <bnu:row>

                            <bnu:column span="6" >
                                <bnu:inputText label="#{messages.companyC}" value="#{customerController.customer.company}" field-size="xs" />
                            </bnu:column>
                            <bnu:column span="2" >
                                <bnu:inputText label="#{messages.phoneC}" value="#{customerController.customer.phone}" field-size="xs" />
                            </bnu:column>
                            <bnu:column span="2" >
                                <bnu:inputText label="#{messages.mobileC}" value="#{customerController.customer.mobile}" field-size="xs" />
                            </bnu:column>
                            <bnu:column span="2" >
                                <bnu:inputText label="#{messages.faxC}" value="#{customerController.customer.fax}" field-size="xs" />

                            </bnu:column>
                        </bnu:row>

                        <bnu:row>


                            <bnu:column span="6" >
                                <label>#{messages.displayN}</label>
                                <bnu:inputText type="text" class="displayName"  field-size="xs" value="#{customerController.customer.displayName}" />
                            </bnu:column>
                            <bnu:column span="2" >
                                <bnu:inputText label="#{messages.Otros}" field-size="xs"   />
                            </bnu:column>
                            <bnu:column span="4" >
                                <bnu:inputText label="#{messages.website}" field-size="xs" value="#{customerController.customer.webside}" />

                            </bnu:column>
                        </bnu:row>


                        <bnu:tabView  activeIndex="0" >
                            <bnu:tab title="#{messages.lblAddress}" >
                                <bnu:row>
                                    <bnu:column span="6" >
                                        <bnu:row>
                                            <bnu:column span="12">
                                                <label>#{messages.billingA}</label>
                                                <bnu:inputTextarea  placeholder="#{messages.streetC}" class="form-control"  value="#{customerController.customer.street}" />
                                            </bnu:column>
                                        </bnu:row>

                                        <bnu:row>
                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.cityT}"  value="#{customerController.customer.city}" />
                                            </bnu:column>

                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.stateP}"  value="#{customerController.customer.estate}" />
                                            </bnu:column>

                                        </bnu:row>

                                        <bnu:row>
                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.postalCC}"  value="#{customerController.customer.postalCode}" />
                                            </bnu:column>

                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.countryC}" value="#{customerController.customer.country}" />
                                            </bnu:column>

                                        </bnu:row>

                                    </bnu:column>
                               
                                    <bnu:column span="6" >
                                        <bnu:row>
                                            <bnu:column span="12">
                                                <label>#{messages.shippingA}</label> <input checked="true" type="checkbox" onclick="customerFormHelper.enableShipAdress()" value="1"  name="sameSha" id="sameSha" />#{messages.sameSHA}
                                                <bnu:inputTextarea placeholder="#{messages.streetC}"  class="form-control shippingEnable"  value="#{customerController.customer.streetS}"   />
                                            </bnu:column>
                                        </bnu:row>
                                        <bnu:row>

                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.cityT}"  class="shippingEnable" value="#{customerController.customer.cityS}" />
                                            </bnu:column>

                                            <bnu:column span="6">
                                                <bnu:inputText placeholder="#{messages.stateP}"  class="shippingEnable" value="#{customerController.customer.estateS}" />
                                            </bnu:column>
                                        </bnu:row>
                                        <bnu:row>

                                    <bnu:column span="6">
                                        <bnu:inputText placeholder="#{messages.postalCC}"  class="shippingEnable" value="#{customerController.customer.postalCodeS}" />
                                    </bnu:column>

                                    <bnu:column span="6">
                                        <bnu:inputText placeholder="#{messages.countryC}"  class="shippingEnable" value="#{customerController.customer.countryS}" />
                                    </bnu:column>
                                </bnu:row>
                                    </bnu:column>

                                
                                

                                </bnu:row>


                            </bnu:tab>
                            <bnu:tab title="#{messages.lblCustNotes }" >
                                <bnu:row>
                                    <bnu:column span="12">
                                        <bnu:inputTextarea label="#{messages.lblCustNotes }"  value="#{customerController.customer.note}" />
                                    </bnu:column>
                                </bnu:row>
                            </bnu:tab>
                            <bnu:tab title="#{messages.taxInfo}" >
                                <bnu:row>
                                    <bnu:column span="4">
                                        <bnu:inputText label="#{messages.lblTaxRegNo}"  value="#{customerController.customer.taxregno}" />
                                    </bnu:column>
                                </bnu:row>
                            </bnu:tab>
                            <bnu:tab title="#{messages.lblPaymentAndBilling}" >
                                <bnu:row>
                                    <bnu:column span="4">
                                        <bnu:selectOneMenu label="#{messages.lblPreferredPayment}" value="#{customerController.customer.paymentMethod}" >
                                            <f:selectItem  itemLabel="#{messages.selectOne}" itemValue=""  />
                                            <f:selectItems value="#{customerDetailController.PMethodList}" var="pm"
                                           itemValue="#{pm.display}" itemLabel="#{pm.display}" />   
                                        </bnu:selectOneMenu>
                                    </bnu:column>
                                    <bnu:column span="4"></bnu:column>
                                    <bnu:column span="4">
                                        <bnu:selectOneMenu label="#{messages.lblInvoiceTerms}"    value="#{customerController.customer.terms}" >
                                            <f:selectItem  itemLabel="#{messages.selectOne}" itemValue="0"  />
                                            <f:selectItems value="#{customerDetailController.TList}" var="term"
                                               itemLabel="#{term.display}" itemValue="#{term.days}" />
                                        </bnu:selectOneMenu>
                                    </bnu:column>
                                </bnu:row>
                                <bnu:row>
                                    <bnu:column span="4">
                                        <bnu:selectOneMenu label="#{messages.lblPrefDelivery}" value="#{customerController.customer.deliveryMethod}" >
                                            <f:selectItem  itemLabel="#{messages.lblNone}" itemValue="#{messages.lblNone}"  />
                                            <f:selectItem  itemLabel="#{messages.lblSendLater}" itemValue="#{messages.lblSendLater}"  />
                                            <f:selectItem  itemLabel="#{messages.lblPrintLater}" itemValue="#{messages.lblPrintLater}"  />
                                        </bnu:selectOneMenu>
                                    </bnu:column>
                                    <bnu:column span="2"></bnu:column>
                                    <bnu:column span="2">
                                        <bnu:inputText  label="#{messages.lblOpeningBalance}"  value="#{customerController.customer.balance}"  />
                                    </bnu:column>
                                    <bnu:column span="4"> <label>#{messages.lblAsOf}</label><bnu:inputText type="date" disabled="true" value="#{customerController.customer.asOf}"  /></bnu:column>
                                </bnu:row>
                            </bnu:tab>
                            <bnu:tab title="#{messages.lblAttachments}" >
                                <bnu:row>
                                    <bnu:column  span="4">
                                        <p:fileUpload />
                                    </bnu:column>
                                    <bnu:column  span="4">
                                        #{messages.lblMaximumSize}
                                    </bnu:column>
                                </bnu:row>
                            </bnu:tab>


                        </bnu:tabView>
                        <bnu:row>
                            <bnu:column span="12">
                                <bnu:messages id="errorMessage"/>
                            </bnu:column>
                        </bnu:row>

                        <f:facet name="footer">
                            <bnu:button value="Close" dismiss="modal"  />
                            <bnu:commandButton value="Save" look="success" update="customerFormAdd:errorMessage"  />
                        </f:facet>
                    </bnu:modal>
                </h:form>

             
                
                
                


                <!-- modal delete-->
                <bnu:modal id="cmodal"  styleClass="modalPseudoClass3" backdrop="false" closable="false" closeOnEscape="false"  >
                    <h:form id="deleteForm">
                        <p>#{messages.deleteC}</p>
                        <bnu:commandButton value="#{messages.yes}" look="success" action="#{customerController.deleteCustomer()}" />
                        <bnu:button value="#{messages.No}" dismiss="modal" look="danger" />
                    </h:form>
                </bnu:modal>
                
                
                
                                 <h:outputScript>
      
                    
                    var customerFormHelper = {
                    shippingDir : 1,
                    displayName: function(){
                    var title = $(".title").val() + ' ';
                    var fname = $(".fname").val() + ' ';
                    var mname = $(".mname").val() + ' ';
                    var lname = $(".lname").val() + ' ';
                    var suffix = $(".suffix").val();
                    $(".displayName").val(title + fname +mname + lname + suffix);
                    },
                    enableShipAdress: function (){
                    if(this.shippingDir == 1){
                    $(".shippingEnable").removeAttr('disabled');

                    this.shippingDir = 2;
                    }else{
                    $(".shippingEnable").attr('disabled',true);
                    $(".shippingEnable").val("");
                    this.shippingDir = 1;
                    }
                    }
                    };
                    

                    $(document).ready(function(){
                        $(".shippingEnable").attr('disabled',true);
                        
                    });
                    
                </h:outputScript>

</ui:fragment>

