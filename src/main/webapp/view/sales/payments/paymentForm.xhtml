<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:bnu="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">
    <f:view locale="#{ userData.locale}"/>
    <h:head>
        <title>Fastbooks</title>
    </h:head>
    <h:body>
        <h:form id="paymentForm" >
            <bnu:container styleClass="marco">
                <bnu:row>
                    <bnu:column span="12">
                        <h3>#{paymentController.title} </h3>

                    </bnu:column>


                </bnu:row> 
                <p:separator/>
                <h:panelGroup id="custs">
                    <bnu:row>
                        <bnu:column span="4">
                            <bnu:selectOneMenu label="#{messages.lblInvocieCustomer}" value="#{paymentController.idCust}" onchange="ajax:paymentController.changeCust();" update="@(.campos)" >
                                <f:selectItem  itemLabel="#{messages.selectOne}" itemValue="0"  />
                                <f:selectItems value="#{paymentController.CList}" var="cust"
                                               itemValue="#{cust.idCust}" itemLabel="#{cust.title} #{cust.firstname} #{cust.lastname}"  itemDescription="#{cust.company}" />
                            </bnu:selectOneMenu>


                        </bnu:column>
                        <bnu:column span="3" class="campos" >
                            <bnu:inputText label="#{messages.email}" value="#{paymentController.email}"  id="email" placeholder="Customer email" maxlength="20"   />

                        </bnu:column>
                        <bnu:column span="3">

                        </bnu:column>
                        <bnu:column span="2" class="campos" >
                            <h4 style="margin-top: -5px">#{messages.lblAmountReceived}</h4>
                            <h1 style="margin-top: -5px" >#{paymentController.DAmount}</h1>
                        </bnu:column>
                    </bnu:row>
                </h:panelGroup>
                <bnu:row>
                    <bnu:column span="2" >
                        <strong>
                            <h:outputText value="#{messages.lblPaymentDate}"  />

                        </strong>
                        <bnu:datepicker style="margin-top: 4px;" value="#{paymentController.paymentDate}" ></bnu:datepicker>
                    </bnu:column>
                </bnu:row>
                <bnu:row>
                    <bnu:column span="4" >
                        <bnu:selectOneMenu label="#{messages.lblPaymentMethod}">
                            <f:selectItems value="#{paymentController.PMethodList}" var="pm"
                                           itemValue="#{pm.display}" itemLabel="#{pm.display}" />
                        </bnu:selectOneMenu>
                    </bnu:column>
                    <bnu:column span="2" >
                        <bnu:inputText label="#{messages.lblReferenceNo}" onkeyup="soloNumeros(this);" maxlength="20" />
                    </bnu:column>
                    <bnu:column span="4" >

                    </bnu:column>
                    <bnu:column span="2" class="campos" >
                        <bnu:inputText label="#{messages.lblAmountReceivedLower}" value="#{paymentController.DAmount}" onblur="ajax:paymentController.calcularPagos();" update="@(.campos)"
                                       id="amount" />
                    </bnu:column>
                </bnu:row>
                <p:separator />
                
                
                <h:panelGroup id="TblTransactions" class="campos"   >
                    
                    <h:panelGroup rendered="#{paymentController.renderMaster('TBL')}" >
                    <bnu:dataTable
                        
                        value="#{paymentController.payDetailList}"
                        var="pd"
                         >
                        <bnu:dataTableColumn label="PAY">
                            <bnu:selectBooleanCheckbox  value="#{pd.checkbox}" onclick="ajax:paymentController.aplicarPagoCheck('#{pd.idInvoice.idInvoice}');" update="@(.campos)" />
                        </bnu:dataTableColumn>
                        <bnu:dataTableColumn label="DESCRIPCION">
                            <h:commandLink action="#{invoiceTableController.edit(pd.idInvoice)}" >  #{pd.descrip} </h:commandLink>
                        </bnu:dataTableColumn>
                        <bnu:dataTableColumn label="DUE DATE">
                            #{pd.dueDate}
                        </bnu:dataTableColumn>
                        <bnu:dataTableColumn label="ORIGINAL AMOUNT">
                            #{paymentController.formatDoubleMaster(pd.originalAmount)}
                        </bnu:dataTableColumn>
                        <bnu:dataTableColumn label="OPEN BALANCE">
                            #{paymentController.formatDoubleMaster(pd.openBalance)}
                        </bnu:dataTableColumn>
                        <bnu:dataTableColumn label="PAYMENT">
                            <bnu:inputText value="#{pd.paymentString}" onblur="ajax:paymentController.aplicarPagoADetalle();" update="@(.campos)" />
                        </bnu:dataTableColumn>
                    </bnu:dataTable>
                    
                    <bnu:row>
                        <bnu:column span="7"/>
                        <bnu:column span="5">
                            <div class="form-group row">
                            <label class="col-form-label col-sm-4" >
                                
                            </label>
                                <label class="col-form-label col-sm-6" >
                                #{messages.lblAmountToApply}
                            </label>
                            <div class="col-sm-2">
                                #{paymentController.DAmountApply}
                            </div>
                        </div>
                            
                            <div class="form-group row">
                                <label class="col-form-label col-sm-4" >
                                
                            </label>
                            <label class="col-form-label col-sm-6" >
                                #{messages.lblAmountToCredit}
                            </label>
                            <div class="col-sm-2">
                                #{paymentController.DAmountCredit}
                            </div>
                        </div>
                            
                            <div class="form-group row">
                            <label class="col-form-label col-sm-8" >
                               
                            </label>
                            <div class="col-sm-4">
                                <bnu:commandButton value="#{messages.lblClearPayment}" />
                            </div>
                        </div>
                        </bnu:column>
                    </bnu:row>
                    </h:panelGroup>
                    
                    
                    <bnu:row rendered="#{paymentController.renderMaster('NO_DATA')}" >
                        <bnu:column span="8">
                            <bnu:alert severity="info" title="#{messages.lblNoTransactionTitle}" >
                                #{messages.lblNoTransactionBody}
                            </bnu:alert >

                        </bnu:column>

                    </bnu:row>
                    
                    
                </h:panelGroup>
                
                
                <bnu:row>
                    <bnu:column  span="4" >
                        <bnu:inputTextarea label="Memo" />
                    </bnu:column>
                </bnu:row>
                <bnu:row>
                    <bnu:column  span="4" >
                        <bnu:inputTextarea label="Attachments" />
                    </bnu:column>
                </bnu:row>
                
                
                
            </bnu:container>

        </h:form>
        
        
        
        <h:outputScript>
            function soloNumeros(obj) 
            { 
            obj.value = (obj.value + '').replace(/[^0-9]/g, '');
            }
            
           
           
        </h:outputScript>
        
    </h:body>
</html>

